cscope 15 $HOME/Work/Graphics/raytracer               0000033293
	@include/camera.h

1 
	~"sim¶e3d/VeùÜ3D.h
"

2 
	~"sim¶e3d/¿y.h
"

3 
	~<veùÜ
>

4 
	~<memÜy
>

6 
Çme¥aû
 
	gRayT¿ûr
{

7 
şass
 
	gSurçû
;

8 
şass
 
	gIÁ”£ùInfo
;

9 
şass
 
	gRGB
;

11 şas 
	cCam”a
{

12 
	gpublic
:

13 
Cam”a
(
fov
, 
foÿlL’
, 
hÜizÚlPixNum
, 
v”tiÿlPixNum
);

14 
	g¡d
::
veùÜ
<
¡d
::veùÜ<
IÁ”£ùInfo
>> 
G‘IÁ”£ùInfo
(cÚ¡ std::veùÜ<¡d::
sh¬ed_±r
<
Surçû
>> &
surçûs
) const;

16 
S‘CªvasO¹hogÚ®
(){

17 
	gm_ÿnvasFixed
 = 
çl£
;

19 
šlše
 
S‘CªvasFixed
(){

20 
	gm_ÿnvasFixed
 = 
Œue
;

23 
šlše
 
G‘HÜizÚtŞPixNum
() const{

24  
	gm_hÜizÚlPixNum
;

27 
šlše
 
G‘V”tiÿlPixNum
() const{

28  
	gm_v”tiÿlPixNum
;

31 
	g´iv©e
:

32 
C®Rays
();

34 
	g´iv©e
:

35 
m_fov
;

36 
	gm_foÿlL’
;

37 
	gm_hÜizÚlPixNum
, 
	gm_v”tiÿlPixNum
;

38 
boŞ
 
	gm_ÿnvasFixed
;

40 
	gSim¶e3D
::
VeùÜ3D
 
m_u
, 
	gm_v
, 
	gm_w
;

41 
	gSim¶e3D
::
Pošt3D
 
m_pos
;

42 
	g¡d
::
veùÜ
<
¡d
::veùÜ<
Sim¶e3D
::
Ray
>> 
m_¿ys
;

	@include/color.h

1 #´agm¨
Úû


3 
Çme¥aû
 
	gRayT¿ûr
{

4 şas 
	cRGB
{

5 
	gpublic
:

6 
r
,
	gg
,
	gb
;

7 
RGB
(cÚ¡ RGB &
r
):rÔ.r), 
g
Ô.g), 
b
(r.b){}

8 
RGB
(){}

9 
RGB
(
r
, 
g
, 
b
):„(r), g(g), b(b){}

11 
RGB
 
	gİ”©Ü
 +(cÚ¡ 
	gRGB
 &
	gr
) const{

12 
RGB
 
	g»suÉ
 = *
this
;

13 
	g»suÉ
 +ğ
r
;

14  
	g»suÉ
;

17 
	gİ”©Ü
 +=(cÚ¡ 
RGB
 &
rgb
){

18 
r
 +ğ
rgb
.r;

19 
	gg
 +ğ
rgb
.
g
;

20 
	gb
 +ğ
rgb
.
b
;

23 
RGB
 
	gİ”©Ü
 * (
	gk
){

24 
RGB
 
	g»suÉ
 = *
this
;

25 
	g»suÉ
.
	gr
 = 
r
 * 
k
;

26 
	g»suÉ
.
	gg
 = 
g
 * 
k
;

27 
	g»suÉ
.
	gb
 = 
b
 * 
k
;

28  
	g»suÉ
;

31 
RGB
 
	gİ”©Ü
 * (cÚ¡ 
	gRGB
 &
	grgb
) const{

32 
RGB
 
	g»suÉ
 = *
this
;

33 
	g»suÉ
.
	gr
 = 
r
 * 
rgb
.r;

34 
	g»suÉ
.
	gg
 = 
g
 * 
rgb
.g;

35 
	g»suÉ
.
	gb
 = 
b
 * 
rgb
.b;

36  
	g»suÉ
;

	@include/light.h

1 #´agm¨
Úû


3 
	~"sim¶e3d/VeùÜ3D.h
"

4 
	~"cŞÜ.h
"

6 
Çme¥aû
 
	gRayT¿ûr
{

7 şas 
	cLight
{

8 
	gpublic
:

9 
RGB
 
š‹ns™y
;

10 
Light
(cÚ¡ 
RGB
 &
c
):
š‹ns™y
(c) {}

11 
Light
(){}

12 ~
Light
() {}

15 şas 
	cDiffu£Light
 : 
public
 
Light
{

16 
public
:

17 
Diffu£Light
(cÚ¡ Diffu£Lighˆ&
s
)

18 :
Light
(
s
), 
dœ
(s.dir){

19 
	gdœ
.
NÜm®ize
();

21 
Diffu£Light
(){}

22 
Diffu£Light
(cÚ¡ 
RGB
 &
c
, cÚ¡ 
Sim¶e3D
::
VeùÜ3D
 &
d
)

23 :
Light
(
c
), 
dœ
(
d
){}

24 ~
Diffu£Light
(){}

26 
	gSim¶e3D
::
VeùÜ3D
 
dœ
;

29 şas 
	cS³cuÏrLight
 : 
public
 
Light
{

30 
public
:

31 
S³cuÏrLight
(cÚ¡ S³cuÏrLighˆ&
s
)

32 :
Light
(
s
), 
dœ
(s.dir){

33 
	gdœ
.
NÜm®ize
();

35 
S³cuÏrLight
(cÚ¡ 
RGB
 &
c
, cÚ¡ 
Sim¶e3D
::
VeùÜ3D
 &
d
)

36 :
Light
(
c
), 
dœ
(
d
){}

37 
S³cuÏrLight
() {}

38 ~
S³cuÏrLight
() {}

40 
	gSim¶e3D
::
VeùÜ3D
 
dœ
;

43 şas 
	cAmb›ÁLight
 : 
public
 
Light
{

44 
public
:

45 
Amb›ÁLight
(){}

46 
Amb›ÁLight
(cÚ¡ 
RGB
 &
c
è:
Light
(c){}

47 ~
Amb›ÁLight
(){}

	@include/material.h

1 #´agm¨
Úû


3 
	~"cŞÜ.h
"

5 
Çme¥aû
 
	gRayT¿ûr
{

6 şas 
	cM©”Ÿl
{

7 
	gpublic
:

8 
RGB
 
k_diffu£
, 
	gk_¥ecuÏr
, 
	gk_amb›Á
;

9 
	g¥ecuÏr_çùÜ
;

	@include/point.h

1 #´agm¨
Úû


3 
Çme¥aû
 
	gSim¶e3D
{

4 şas 
	cPošt2D
{

5 
	gpublic
:

6 
x
, 
	gy
;

7 
Pošt2D
(){}

8 
Pošt2D
(cÚ¡ Pošt2D &
p
):
x
Õ.x), 
y
(p.y) { }

9 
Pošt2D
(
x
, 
y
):x(x), y(y) {}

10 ~
Pošt2D
(){}

14 şas 
	cPošt3D
{

15 
	gpublic
:

16 
x
, 
	gy
, 
	gz
;

17 
Pošt3D
(){}

18 
Pošt3D
(
x
, 
y
, 
z
)

19 :
x
(x), 
y
(y), 
z
(z) { }

21 
Pošt3D
(cÚ¡ Pošt3D &
p
)

22 :
x
(
p
.x), 
y
Õ.y), 
z
(p.z) { }

23 ~
Pošt3D
() {}

26 
šlše
 
Pošt3D
 
	gİ”©Ü
 - () const {

27  
Pošt3D
(-
x
, -
y
, -
z
);

30 
šlše
 
Pošt3D
 
	gİ”©Ü
 + (cÚ¡ 
	gPošt3D
& 
	gp
) const {

31 
Pošt3D
 
	gt
 = *
this
;

32 
	gt
 +ğ
p
;

33  
	gt
;

36 
šlše
 
Pošt3D
 
	gİ”©Ü
 - (cÚ¡ 
	gPošt3D
& 
	gp
) const {

37 
Pošt3D
 
	gt
 = *
this
;

38 
	gt
 -ğ
p
;

39  
	gt
;

42 
šlše
 
Pošt3D
 
	gİ”©Ü
 * (
	gsÿË
) const {

43 
Pošt3D
 
	gt
 = *
this
;

44 
	gt
 *ğ
sÿË
;

45  
	gt
;

48 
šlše
 
Pošt3D
 
	gİ”©Ü
 / (
	gsÿË
) const {

49 
Pošt3D
 
	gt
 = *
this
;

50 
	gt
 /ğ
sÿË
;

51  
	gt
;

55 
šlše
 
	gİ”©Ü
 +ğ(cÚ¡ 
Pošt3D
& 
p
) {

56 
x
 +ğ
p
.x;

57 
	gy
 +ğ
p
.
y
;

58 
	gz
 +ğ
p
.
z
;

61 
šlše
 
	gİ”©Ü
 -ğ(cÚ¡ 
Pošt3D
& 
p
) {

62 
x
 -ğ
p
.x;

63 
	gy
 -ğ
p
.
y
;

64 
	gz
 -ğ
p
.
z
;

67 
šlše
 
	gİ”©Ü
 *ğ(
r
) {

68 
x
 *ğ
r
;

69 
	gy
 *ğ
r
;

70 
	gz
 *ğ
r
;

73 
šlše
 
	gİ”©Ü
 /ğ(
r
) {

74 
x
 /ğ
r
;

75 
	gy
 /ğ
r
;

76 
	gz
 /ğ
r
;

79 
šlše
 
boŞ
 
	gİ”©Ü
 =ğ(cÚ¡ 
Pošt3D
 &
p
) const{

80  
x
 =ğ
p
.x && 
y
 =ğp.y && 
z
==….z;

	@include/ray.h

1 #´agm¨
Úû


3 
	~"pošt.h
"

4 
	~"VeùÜ3D.h
"

6 
Çme¥aû
 
	gSim¶e3D
{

7 şas 
	cRay
{

8 
	gpublic
:

9 
Ray
(cÚ¡ 
Pošt3D
 &
ps
, cÚ¡ Pošt3D &
±
, 
rs
, 
»
)

10 :
m_poštS¹
(
ps
), 
m_poštT
(
±
), 
m_¿tioS¹
(
rs
), 
m_¿tioEnd
(
»
),

11 
m_dœ
(
±
.
x
 - 
ps
.x,…t.
y
 -…s.y,…t.
z
 -…s.z)

13 
	gm_dœ
.
NÜm®ize
();

17 
Ray
(cÚ¡ Ray &
r
)

18 :
m_poštS¹
(
r
.m_poštS¹), 
m_poštT
(r.m_pointT),

19 
m_¿tioS¹
(
r
.m_¿tioS¹), 
m_¿tioEnd
(r.m_ratioEnd),

20 
m_dœ
(
r
.m_dir){ }

22 
Ray
(cÚ¡ 
Pošt3D
 &
ps
, cÚ¡ 
VeùÜ3D
 &
dœ
, 
rs
, 
»
)

23 :
m_poštS¹
(
ps
),

24 
m_poštT
(
m_poštS¹
.
x
 + 
dœ
.x, m_poštS¹.
y
 + dœ.y, m_poštS¹.
z
 + dir.z),

25 
m_¿tioS¹
(
rs
), 
m_¿tioEnd
(
»
), 
m_dœ
(
dœ
)

27 
	gm_dœ
.
NÜm®ize
();

30 
šlše
 
Pošt3D
 
G‘Pošt
(
r
) const{

31  
	gm_poštS¹
 + (
	gm_poštT
 - m_poštS¹è* 
	gr
;

34 
šlše
 cÚ¡ 
	gVeùÜ3D
& 
G‘Dœ
() const{

35  
	gm_dœ
;

38 
šlše
 
G‘S¹R©io
(ècÚ¡{ 
	gm_¿tioS¹
;}

39 
šlše
 
G‘EndR©io
(ècÚ¡{ 
	gm_¿tioEnd
;}

42 
	g´iv©e
:

43 cÚ¡ 
Pošt3D
 
m_poštS¹
, 
	gm_poštT
;

44 
	gm_¿tioS¹
, 
	gm_¿tioEnd
;

45 
VeùÜ3D
 
	gm_dœ
;

	@include/render.h

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~"light.h
"

5 
	~<memÜy
>

6 
	~"surçû.h
"

8 
Çme¥aû
 
	gSim¶e3D
{

9 
şass
 
	gVeùÜ3D
;

12 
Çme¥aû
 
	gRayT¿ûr
{

13 
şass
 
	gIÁ”£ùInfo
;

14 
şass
 
	gCam”a
;

15 
şass
 
	gRGB
;

17 şas 
	cR’d”
{

18 
	gpublic
:

19 
R’d”
(){}

20 ~
R’d”
(){}

22 
D¿w
(cÚ¡ 
Cam”a
 &
ÿm”a
, cÚ¡ 
¡d
::
veùÜ
<¡d::
sh¬ed_±r
<
Surçû
>> &
surçûs
);

25 
šlše
 
S‘Diffu£Light
(cÚ¡ 
Diffu£Light
 &
d
){

26 
	gm_diffu£Light
 = 
d
;

29 
šlše
 
AddS³cuÏrLight
(cÚ¡ 
S³cuÏrLight
 &
s
){

30 
	gm_¥ecuÏrLightLi¡
.
push_back
(
s
);

33 
šlše
 
S‘Amb›ÁLight
(cÚ¡ 
Amb›ÁLight
 &
a
){

34 
	gm_amb›ÁLight
 = 
a
;

37 
	g´iv©e
:

38 
C®cuÏ‹CŞÜ
(cÚ¡ 
IÁ”£ùInfo
 &
šfo
, 
RGB
 &
rgb
) const;

39 
RGB
 
Diffu£CŞÜ
(cÚ¡ RGB &
k
, cÚ¡ RGB &
i
, cÚ¡ 
Sim¶e3D
::
VeùÜ3D
 &
l
, cÚ¡ Sim¶e3D::VeùÜ3D &
n
) const;

40 
RGB
 
S³cuÏrCŞÜ
(cÚ¡ RGB &
k
, cÚ¡ RGB &
i
, cÚ¡ 
Sim¶e3D
::
VeùÜ3D
 &
l
, cÚ¡ Sim¶e3D::VeùÜ3D &
n
, cÚ¡ Sim¶e3D::VeùÜ3D &
v
, 
çùÜ
) const;

41 
RGB
 
Amb›ÁCŞÜ
(cÚ¡ RGB &
k
, cÚ¡ RGB &
i
) const;

43 
	g´iv©e
:

44 
Diffu£Light
 
m_diffu£Light
;

45 
	g¡d
::
veùÜ
<
S³cuÏrLight
> 
m_¥ecuÏrLightLi¡
;

46 
Amb›ÁLight
 
	gm_amb›ÁLight
;

	@include/surface.h

1 #´agm¨
Úû


3 
	~"sim¶e3d/VeùÜ3D.h
"

4 
	~"sim¶e3d/pošt.h
"

5 
	~"sim¶e3d/¿y.h
"

6 
	~"m©”Ÿl.h
"

8 
Çme¥aû
 
	gRayT¿ûr
 {

9 
şass
 
	gM©”Ÿl
;

10 şas 
	cIÁ”£ùInfo
{

11 
	gpublic
:

12 
¿tio
;

13 
	gSim¶e3D
::
Ray
 
r
;

14 
	gSim¶e3D
::
Pošt3D
 
š‹rPošt
;

15 
	gSim¶e3D
::
VeùÜ3D
 
surçûNÜm®
;

16 cÚ¡ 
	gM©”Ÿl
 &
	gm©
;

18 
IÁ”£ùInfo
(cÚ¡ 
M©”Ÿl
 &
m
, 
Sim¶e3D
::
Ray
 
r
):
¿tio
(0),„Ô), 
š‹rPošt
(), 
surçûNÜm®
(), 
m©
(m){}

19 
šlše
 
boŞ
 
IsEm±y
() const{

20  
	g¿tio
 =ğ0 && 
š‹rPošt
=ğ
Sim¶e3D
::
Pošt3D
(è&& 
surçûNÜm®
=ğSim¶e3D::
VeùÜ3D
();

24 şas 
	cSurçû
{

25 
	gpublic
:

26 
Surçû
(cÚ¡ 
M©”Ÿl
 &
m
):
m_m©
(m){}

27 
vœtu®
 
boŞ
 
IÁ”£ùW™hRay
(cÚ¡ 
Sim¶e3D
::
Ray
 &
r
, 
IÁ”£ùInfo
 &
šfo
) const = 0;

28 cÚ¡ 
	gM©”Ÿl
 &
G‘M©”Ÿl
(ècÚ¡{ 
	gm_m©
;};

30 
	g´iv©e
:

31 cÚ¡ 
M©”Ÿl
 &
m_m©
;

35 şas 
	cTrŸngË
 : 
public
 
Surçû
{

36 
public
:

37 
TrŸngË
(cÚ¡ 
M©”Ÿl
 &
m
, cÚ¡ 
Sim¶e3D
::
Pošt3D
 &
a
, cÚ¡ Sim¶e3D::Pošt3D &
b
, cÚ¡ Sim¶e3D::Pošt3D &
c
)

38 :
Surçû
(
m
), 
a
×), 
b
(b), 
c
(c)

40 
	gnÜm®
 = 
Cross
(
Sim¶e3D
::
VeùÜ3D
(
b
.
x
 - 
a
.x, b.
y
 -‡.y, b.
z
 -‡.z), Sim¶e3D::VeùÜ3D(
c
.x -‡.x, c.y -‡.y, c.z -‡.z));

41 
	gnÜm®
.
NÜm®ize
();

43 
TrŸngË
(cÚ¡ TrŸngË &
t
):
Surçû
Ñ), 
a
Ñ.a), 
b
Ñ.b), 
c
(t.c){}

44 
boŞ
 
IÁ”£ùW™hRay
(cÚ¡ 
Sim¶e3D
::
Ray
 &
r
, 
IÁ”£ùInfo
 &
šfo
) const;

46 
	g´iv©e
:

47 
Sim¶e3D
::
Pošt3D
 
a
,
	gb
,
	gc
;

48 
	gSim¶e3D
::
VeùÜ3D
 
nÜm®
;

51 şas 
	cSph”e
 : 
public
 
Surçû
{

52 
public
:

53 
Sph”e
(cÚ¡ 
M©”Ÿl
 &
m
, cÚ¡ 
Sim¶e3D
::
Pošt3D
 &
c
, 
r
)

54 :
Surçû
(
m
), 
ûÁ”
(
c
), 
¿dius
(
r
){}

55 
boŞ
 
IÁ”£ùW™hRay
(cÚ¡ 
Sim¶e3D
::
Ray
 &
r
, 
IÁ”£ùInfo
 &
šfo
) const;

57 
	g´iv©e
:

58 
Sim¶e3D
::
Pošt3D
 
ûÁ”
;

59 
	g¿dius
;

	@simple3d/Matrix33.cc

1 
	~"M©rix33.h
"

3 
Çme¥aû
 
	gSim¶e3D
 {

5 
	gM©rix33
::
M©rix33
(cÚ¡ 
VeùÜ3D
 &
v1
, cÚ¡ VeùÜ3D &
v2
, cÚ¡ VeùÜ3D &
v3
)

7 
	g’Œ›s
.
push_back
(
v1
);

8 
	g’Œ›s
.
push_back
(
v2
);

9 
	g’Œ›s
.
push_back
(
v3
);

12 
	gM©rix33
::
M©rix33
(
v11
, 
v12
, 
v13
, 
v21
, 
v22
, 
v23
, 
v31
, 
v32
, 
v33
){

13 
	g’Œ›s
.
push_back
(
VeùÜ3D
(
v11
, 
v12
, 
v13
));

14 
	g’Œ›s
.
push_back
(
VeùÜ3D
(
v21
, 
v22
, 
v23
));

15 
	g’Œ›s
.
push_back
(
VeùÜ3D
(
v31
, 
v32
, 
v33
));

19 
	gM©rix33
::
D‘
() const{

20  
’Œ›s
[0][0] * (entries[1][1] *ƒntries[2][2] -ƒntries[1][2] *ƒntries[2][1])

21 + 
’Œ›s
[0][1] * (entries[1][2] *ƒntries[2][0] -ƒntries[1][0] *ƒntries[2][2])

22 + 
’Œ›s
[0][2] * (entries[1][0] *ƒntries[2][1] -ƒntries[1][1] *ƒntries[2][0]);

25 
	gM©rix33
::
D‘
(
row
, 
cŞ
) const{

26 
	gm
[2][2];

27 
	gm_row
, 
	gm_cŞ
;

28 
	gi
 = 0; i < 3; i++) {

29 ià(
	gi
 !ğ
row
) {

30 
m_row
 = (
i
 > 
row
) ? i - 1 : i;

31 
	gj
 = 0; j < 3; j++) {

32 ià(
	gj
 !ğ
cŞ
) {

33 
m_cŞ
 = (
j
 > 
cŞ
) ? j - 1 : j;

34 
	gm
[
m_row
][
m_cŞ
] = 
’Œ›s
[
i
][
j
];

40  
	gm
[0][0] * m[1][1] - m[0][1] * m[1][0];

43 
M©rix33
 
	gM©rix33
::
T¿nsãr
() {

44 
M©rix33
 
m
;

45 
	gi
 = 0; i < 3; i++) {

46 
	gj
 = 0; j < 3; j++) {

47 
	gm
[
i
][
j
] = 
’Œ›s
[j][i];

50  
	gm
;

53 
M©rix33
 
	gM©rix33
::
Inv”£
() {

54 
d‘
 = 
D‘
();

55 ià(
	gd‘
 == 0) {

56 
as£¹
(0);

59 
	gcoçùÜ
 = 0;

60 
M©rix33
 
	gm
;

61 
	gi
 = 0; i < 3;i++) {

62 
	gj
 = 0; j < 3;j++) {

63 
	gšdex
 = ((
i
 + 
j
) % 2 == 0) ? 1 : -1;

64 
	gcoçùÜ
 *ğ
šdex
 * 
D‘
(
j
, 
i
);

65 
	gm
[
i
][
j
] = 
coçùÜ
 / 
d‘
;

68  
	gm
;

71 
	gM©rix33
::
NÜm
() const{

72 
sum
 = 0;

73 
	gi
 = 0; i < 3; i++) {

74 
	gj
 = 0; j < 3; j++) {

75 
	gsum
 +ğ
’Œ›s
[
i
][
j
] *ƒntries[i][j];

79  
sq¹
(
sum
);

82 
VeùÜ3D
 
	gM©rix33
::
CŞumn
(
šdex
) const {

83 
VeùÜ3D
 
cŞ
;

84 
	gi
 = 0; i < 3; i++) {

85 
	gcŞ
[
i
] = 
’Œ›s
[i][
šdex
];

87  
	gcŞ
;

90 
M©rix33
 
	gM©rix33
::
İ”©Ü
 *(cÚ¡ M©rix33& 
m
) const {

91 
M©rix33
 
»suÉ
;

92 
	gi
 = 0; i < 3; i++) {

93 
	gj
 = 0; j < 3; j++) {

94 
	g»suÉ
[
i
][
j
] = 
DÙ
(
’Œ›s
[i] , 
m
.
CŞumn
(j));

98  
	g»suÉ
;

101 
VeùÜ3D
 
	gM©rix33
::
İ”©Ü
 *(cÚ¡ VeùÜ3D& 
m
) const {

102 
VeùÜ3D
 
»suÉ
;

103 
	gi
 = 0; i < 3; i++) {

104 
	g»suÉ
[
i
] = 
DÙ
(
’Œ›s
[i], 
m
);

107  
	g»suÉ
;

110 
M©rix33
 
	gM©rix33
::
İ”©Ü
 *(
d
) const {

111 
M©rix33
 
»suÉ
;

112 
	gi
 = 0; i < 3; i++) {

113 
	gj
 = 0; j < 3; j++) {

114 
	g»suÉ
[
i
][
j
] *ğ
d
;

118  
	g»suÉ
;

122 
	gM©rix33
::
İ”©Ü
 +=(cÚ¡ 
M©rix33
& 
m
) {

123 
i
 = 0; 
	gi
 < 3;) {

124 
	gj
 = 0; j < 3; 
	gi
++) {

125 
	g’Œ›s
[
i
][
j
] +ğ
m
[i][j];

130 
	gM©rix33
::
İ”©Ü
 -=(cÚ¡ 
M©rix33
& 
m
) {

131 
i
 = 0; 
	gi
 < 3; i++) {

132 
	gj
 = 0; j < 3; j++) {

133 
	g’Œ›s
[
i
][
j
] -ğ
m
[i][j];

138 
M©rix33
 
	gM©rix33
::
İ”©Ü
+(cÚ¡ M©rix33& 
m
) const{

139 
M©rix33
 
»suÉ
;

140 
	gi
 = 0; i < 3; i++) {

141 
	gj
 = 0; j < 3;) {

142 
	g»suÉ
[
i
][
j
] = 
’Œ›s
[i][j] + 
m
[i][j];

146  
	g»suÉ
;

149 
M©rix33
 
	gM©rix33
::
İ”©Ü
-(cÚ¡ M©rix33& 
m
) const{

150 
M©rix33
 
»suÉ
;

151 
	gi
 = 0; i < 3; i ++) {

152 
	gj
 = 0; j < 3; j ++) {

153 
	g»suÉ
[
i
][
j
] = 
’Œ›s
[i][j] - 
m
[i][j];

157  
	g»suÉ
;

160 
M©rix33
 
Ou‹r
(cÚ¡ 
VeùÜ3D
& 
v1
, cÚ¡ VeùÜ3D& 
v2
){

161 
M©rix33
 
	g»suÉ
;

162 
	gi
 = 0; i < 3; i++) {

163 
	gj
 = 0; j < 3; j++) {

164 
	g»suÉ
[
i
][
j
] = 
v1
[i] * 
v2
[j];

168  
	g»suÉ
;

171 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gM©rix33
& 
	gA
) {

172 
	gi
 = 0; i < 3; i++) {

173 
	gj
 = 0; j < 3; j++) {

174 
	gos
 << 
	gA
[
i
][
j
];

175 
	gos
 << " ";

177 
	gos
 << "\n";

179  
	gos
;

	@simple3d/Matrix33.h

1 #´agm¨
Úû


3 
	~"VeùÜ3D.h
"

4 
	~<veùÜ
>

5 
	~<io¡»am
>

14 
Çme¥aû
 
	gSim¶e3D
 {

15 şas 
	cM©rix33


17 
	g¡d
::
veùÜ
<
VeùÜ3D
> 
’Œ›s
;

19 
	gpublic
:

20 
M©rix33
() {}

21 
M©rix33
(cÚ¡ 
VeùÜ3D
 &
v1
, cÚ¡ VeùÜ3D &
v2
, cÚ¡ VeùÜ3D &
v3
);

22 
M©rix33
(
v11
, 
v12
, 
v13
, 
v21
, 
v22
, 
v23
, 
v31
, 
v32
, 
v33
);

23 ~
M©rix33
(){}

26 
šlše
 
	gVeùÜ3D
& 
	gİ”©Ü
[](
	gšdex
) {

27 
as£¹
(
šdex
 >= 0 & index < 3);

28  
	g’Œ›s
[
šdex
];

31 
šlše
 cÚ¡ 
	gVeùÜ3D
& 
	gİ”©Ü
[](
	gšdex
) const {

32 
as£¹
(
šdex
 >= 0 & index < 3);

33  
	g’Œ›s
[
šdex
];

36 
VeùÜ3D
 
CŞumn
(
šdex
) const;

37 
NÜm
() const;

39 
M©rix33
 
	gİ”©Ü
 * (cÚ¡ 
	gM©rix33
& 
	gm
) const;

40 
VeùÜ3D
 
	gİ”©Ü
 * (cÚ¡ 
	gVeùÜ3D
& 
	gm
) const;

41 
M©rix33
 
	gİ”©Ü
 * (
	gc
) const;

43 
	gİ”©Ü
 +ğ(cÚ¡ 
M©rix33
& 
m
);

44 
	gİ”©Ü
 -ğ(cÚ¡ 
M©rix33
& 
m
);

45 
M©rix33
 
	gİ”©Ü
 + (cÚ¡ 
	gM©rix33
& 
	gm
) const;

46 
M©rix33
 
	gİ”©Ü
 - (cÚ¡ 
	gM©rix33
& 
	gm
) const;

48 
D‘
() const;

49 
D‘
(
row
, 
cŞ
) const;

51 
M©rix33
 
T¿nsãr
();

53 
M©rix33
 
Inv”£
();

56 
M©rix33
 
Ou‹r
(cÚ¡ 
VeùÜ3D
& 
v1
, cÚ¡ VeùÜ3D& 
v2
);

57 
	g¡d
::
o¡»am
& 
İ”©Ü
<<(
¡d
::o¡»am& 
os
, cÚ¡ 
	gM©rix33
& 
	gA
);

	@simple3d/Vector2D.h

1 #´agm¨
Úû


3 
	~<cm©h
>

5 
Çme¥aû
 
	gSim¶e3D
 {

6 şas 
	cVeùÜ2D


8 
	gpublic
:

9 
x
, 
	gy
;

11 
VeùÜ2D
(è:
x
(0.0), 
y
(0.0) {}

12 
VeùÜ2D
(
x
, 
y
) : x(x), y(y) {}

13 
VeùÜ2D
(cÚ¡ VeùÜ2D & 
v
è: 
x
(v.x), 
y
(v.y) {}

15 
šlše
 
VeùÜ2D
 
	gİ”©Ü
 - () const{

16  
VeùÜ2D
(-
x
, -
y
);

19 
šlše
 
VeùÜ2D
 
	gİ”©Ü
 + (cÚ¡ 
	gVeùÜ2D
& 
	gp
) const{

20 
VeùÜ2D
 
	gt
 = *
this
;

21 
	gt
 +ğ
p
;

22  
	gt
;

25 
šlše
 
VeùÜ2D
 
	gİ”©Ü
 - (cÚ¡ 
	gVeùÜ2D
& 
	gp
) const{

26 
VeùÜ2D
 
	gt
 = *
this
;

27 
	gt
 -ğ
p
;

28  
	gt
;

31 
šlše
 
VeùÜ2D
 
	gİ”©Ü
 * (
	gsÿË
) const{

32 
VeùÜ2D
 
	gt
 = *
this
;

33 
	gt
 *ğ
sÿË
;

34  
	gt
;

37 
šlše
 
VeùÜ2D
 
	gİ”©Ü
 / (
	gsÿË
) const{

38 
VeùÜ2D
 
	gt
 = *
this
;

39 
	gt
 /ğ
sÿË
;

40  
	gt
;

44 
šlše
 
	gİ”©Ü
 +ğ(cÚ¡ 
VeùÜ2D
& 
p
) {

45 
y
 +ğ
p
.y;

46 
	gx
 +ğ
p
.
x
;

49 
šlše
 
	gİ”©Ü
 -ğ(cÚ¡ 
VeùÜ2D
& 
p
) {

50 
y
 -ğ
p
.y;

51 
	gx
 -ğ
p
.
x
;

54 
šlše
 
	gİ”©Ü
 *ğ(
r
) {

55 
y
 *ğ
r
;

56 
	gx
 *ğ
r
;

59 
šlše
 
	gİ”©Ü
 /ğ(
r
) {

60 
y
 /ğ
r
;

61 
	gx
 /ğ
r
;

64 
šlše
 
NÜm
() {

65  
sq¹
(
x
 * x + 
y
 * y);

68 
šlše
 
VeùÜ2D
 
Un™
() {

69  *
	gthis
 / 
NÜm
();

72 
šlše
 
NÜm®ize
() {

73 
	gx
 /ğ
NÜm
();

74 
	gy
 /ğ
NÜm
();

78 
šlše
 
	$Cross
(cÚ¡ 
VeùÜ2D
& 
v1
, cÚ¡ VeùÜ2D& 
v2
) {

79  
v1
.
x
 * 
v2
.
y
 - v1.y * v2.x;

80 
	}
}

82 
šlše
 
	$DÙ
(cÚ¡ 
VeùÜ2D
& 
v1
, cÚ¡ VeùÜ2D& 
v2
) {

83  
v1
.
x
 * 
v2
.x + v1.
y
 * v2.y;

84 
	}
}

86 
šlše
 
VeùÜ2D
 
	gİ”©Ü
*(
	gr
, cÚ¡ 
	gVeùÜ2D
& 
	gv
) {

87  
v
 * 
	gr
;

	@simple3d/Vector3D.h

1 #´agm¨
Úû


3 
	~<as£¹.h
>

4 
	~<cm©h
>

6 
Çme¥aû
 
	gSim¶e3D
 {

7 şas 
	cVeùÜ3D


9 
	gpublic
:

10 
x
, 
	gy
, 
	gz
;

12 
VeùÜ3D
(è:
x
(0.0), 
y
(0.0), 
z
(0.0) {}

13 
VeùÜ3D
(
x
, 
y
, 
z
) : x(x), y(y), z(z){}

14 
VeùÜ3D
(cÚ¡ VeùÜ3D & 
v
è: 
x
(v.x), 
y
(v.y), 
z
(v.z){}

16 
šlše
 & 
	gİ”©Ü
 [](
	gšdex
){

17  (&
	gx
)[
šdex
];

20 
šlše
 cÚ¡ & 
	gİ”©Ü
 [](
	gšdex
) const{

21  (&
	gx
)[
šdex
];

24 
šlše
 
VeùÜ3D
 
	gİ”©Ü
 - () const {

25  
VeùÜ3D
(-
x
, -
y
, -
z
);

28 
šlše
 
VeùÜ3D
 
	gİ”©Ü
 + (cÚ¡ 
	gVeùÜ3D
& 
	gp
) const {

29 
VeùÜ3D
 
	gt
 = *
this
;

30 
	gt
 +ğ
p
;

31  
	gt
;

34 
šlše
 
VeùÜ3D
 
	gİ”©Ü
 - (cÚ¡ 
	gVeùÜ3D
& 
	gp
) const {

35 
VeùÜ3D
 
	gt
 = *
this
;

36 
	gt
 -ğ
p
;

37  
	gt
;

40 
šlše
 
VeùÜ3D
 
	gİ”©Ü
 * (
	gsÿË
) const {

41 
VeùÜ3D
 
	gt
 = *
this
;

42 
	gt
 *ğ
sÿË
;

43  
	gt
;

46 
šlše
 
VeùÜ3D
 
	gİ”©Ü
 / (
	gsÿË
) const {

47 
VeùÜ3D
 
	gt
 = *
this
;

48 
	gt
 /ğ
sÿË
;

49  
	gt
;

53 
šlše
 
	gİ”©Ü
 +ğ(cÚ¡ 
VeùÜ3D
& 
p
) {

54 
x
 +ğ
p
.x;

55 
	gy
 +ğ
p
.
y
;

56 
	gz
 +ğ
p
.
z
;

59 
šlše
 
	gİ”©Ü
 -ğ(cÚ¡ 
VeùÜ3D
& 
p
) {

60 
x
 -ğ
p
.x;

61 
	gy
 -ğ
p
.
y
;

62 
	gz
 -ğ
p
.
z
;

65 
šlše
 
	gİ”©Ü
 *ğ(
r
) {

66 
x
 *ğ
r
;

67 
	gy
 *ğ
r
;

68 
	gz
 *ğ
r
;

71 
šlše
 
	gİ”©Ü
 /ğ(
r
) {

72 
x
 /ğ
r
;

73 
	gy
 /ğ
r
;

74 
	gz
 /ğ
r
;

77 
šlše
 
NÜm
() {

78  
sq¹
(
x
 * x + 
y
 * y + 
z
 * z);

81 
šlše
 
VeùÜ3D
 
Un™
() {

82  (*
	gthis
è/ 
NÜm
();

85 
šlše
 
NÜm®ize
() {

86 
	gx
 /ğ
NÜm
();

87 
	gy
 /ğ
NÜm
();

88 
	gz
 /ğ
NÜm
();

91 
šlše
 
boŞ
 
	gİ”©Ü
 ==(cÚ¡ 
VeùÜ3D
 &
v
) const{

92  
x
 =ğ
v
.x && 
y
 =ğv.y && 
z
 == v.z;

96 
šlše
 
VeùÜ3D
 
	$Cross
(cÚ¡ 
VeùÜ3D
& 
v1
, cÚ¡ VeùÜ3D& 
v2
) {

97  
	`VeùÜ3D
(
v1
.
y
 * 
v2
.
z
 - v1.z * v2.y, v1.z * v2.
x
 - v1.x * v2.z, v1.x * v2.y - v1.y * v2.x);

98 
	}
}

100 
šlše
 
	$DÙ
(cÚ¡ 
VeùÜ3D
& 
v1
, cÚ¡ VeùÜ3D& 
v2
) {

101  
v1
.
x
 * 
v2
.x + v1.
y
 * v2.y + v1.
z
 * v2.z;

102 
	}
}

104 
šlše
 
VeùÜ3D
 
	gİ”©Ü
*(
	gr
, cÚ¡ 
	gVeùÜ3D
& 
	gv
) {

105  
v
 * 
	gr
;

	@simple3d/commondef.h

1 #´agm¨
Úû


3 
	~<cm©h
>

5 
Çme¥aû
 
	gSim¶e3D
{

6 cÚ¡ 
	gPI
 = 
acos
(-1);

	@src/camera.cc

1 
	~"ÿm”a.h
"

2 
	~"sim¶e3d/commÚdef.h
"

3 
	~"sim¶e3d/M©rix33.h
"

4 
	~"surçû.h
"

5 
	~"cŞÜ.h
"

6 
	~<cm©h
>

8 
usšg
 
	g¡d
::
veùÜ
;

9 
usšg
 
	g¡d
::
sh¬ed_±r
;

10 
usšg
 
Çme¥aû
 
	gSim¶e3D
;

12 
Çme¥aû
 
	gRayT¿ûr
{

13 
	gCam”a
::
Cam”a
(
fov
, 
foÿlL’
, 
hÜizÚlPixNum
, 
v”tiÿlPixNum
)

14 :
m_fov
(
fov
), 
m_foÿlL’
(
foÿlL’
), 
m_hÜizÚlPixNum
(
hÜizÚlPixNum
), 
m_v”tiÿlPixNum
(
v”tiÿlPixNum
),

15 
m_ÿnvasFixed
(
çl£
), 
m_u
(0.0, 1.0, 0.0), 
m_v
(0.0, 0.0, 1.0), 
m_w
(1.0, 0.0, 0.0), 
m_pos
(), 
m_¿ys
(
m_v”tiÿlPixNum
){

16 
C®Rays
();

19 
	g¡d
::
veùÜ
<veùÜ<
IÁ”£ùInfo
>> 
Cam”a
::
G‘IÁ”£ùInfo
(cÚ¡ veùÜ<
sh¬ed_±r
<
Surçû
>> &
surçûs
) const{

20 
¡d
::
veùÜ
<veùÜ<
IÁ”£ùInfo
>> 
šfoLi¡
(
m_v”tiÿlPixNum
);

21 autØ
	gi_row
 = 
m_¿ys
.
begš
();

22 autØ
	gi_šfoRow
 = 
šfoLi¡
.
begš
();

23 
	gi_row
 !ğ
m_¿ys
.
’d
()){

24 autØ
i_¿y
 = (*
i_row
).
begš
();

25 
	gi_¿y
 !ğ(*
i_row
).
’d
()){

26 
IÁ”£ùInfo
 *
mš
 = 
NULL
;

27 autØ
	gi_surçû
 = 
surçûs
.
begš
();

28 
IÁ”£ùInfo
 
šfo
((*
i_surçû
)->
G‘M©”Ÿl
(), *
i_¿y
);

29 
	gi_surçû
 !ğ
surçûs
.
’d
()){

30 if((*
i_surçû
)->
IÁ”£ùW™hRay
(*
i_¿y
, 
šfo
)){

31 if(!
mš
)

32 
mš
 = &
šfo
;

33 if(
	gmš
->
	g¿tio
 > 
	gšfo
.ratio)

34 
	gmš
 = &
šfo
;

36 
	gi_surçû
++;

39 
	gi_šfoRow
->
push_back
(*
mš
);

40 
	gi_¿y
++;

42 
	gi_row
++;

43 
	gi_šfoRow
++;

45  
	gšfoLi¡
;

49 
	gCam”a
::
C®Rays
(){

50 
m_¿ys
.
ş—r
();

52 
	gÿnvasH®fV
 = 
m_foÿlL’
 * 
n
(
m_fov
);

53 
	gÿnvasH®fU
 = 
m_hÜizÚlPixNum
 / 
m_v”tiÿlPixNum
 * 
ÿnvasH®fV
;

55 
VeùÜ3D
 
pLeáDownInUVW
(-
m_foÿlL’
, -
ÿnvasH®fU
, -
ÿnvasH®fV
);

57 
M©rix33
 
Œªsãr
(
m_w
, 
m_u
, 
m_v
);

58 
	gŒªsãr
 = 
Œªsãr
.
Inv”£
();

60 
	gj
 = 0 ; j < 
	gm_v”tiÿlPixNum
 ; j++){

61 
	gi
 = 0 ; i < 
	gm_hÜizÚlPixNum
 ; i++){

62 
	gposU
 = 
pLeáDownInUVW
.
y
 + 
ÿnvasH®fU
 * (
i
 + 0.5è/ 
m_hÜizÚlPixNum
;

63 
	gposV
 = 
pLeáDownInUVW
.
z
 + 
ÿnvasH®fV
 * (
j
 + 0.5è/ 
m_v”tiÿlPixNum
;

65 
VeùÜ3D
 
p
(
pLeáDownInUVW
.
x
, 
posU
, 
posV
);

66 
	gp
 = 
Œªsãr
 * 
p
;

67 
	gm_¿ys
[
j
].
push_back
(
Ray
(
m_pos
, 
p
, 0, 1000));

	@src/main.cc

1 
	~"»nd”.h
"

2 
	~"m©”Ÿl.h
"

3 
	~"surçû.h
"

4 
	~"ÿm”a.h
"

5 
	~"sim¶e3d/commÚdef.h
"

6 
	~<io¡»am
>

8 
usšg
 
Çme¥aû
 
	gRayT¿ûr
;

9 
usšg
 
Çme¥aû
 
	gSim¶e3D
;

10 
usšg
 
	g¡d
::
veùÜ
;

11 
usšg
 
	g¡d
::
sh¬ed_±r
;

12 
usšg
 
	g¡d
::
make_sh¬ed
;

14 
	$maš
(){

15 
M©”Ÿl
 
m©
 = {
	`RGB
(0.1, 0.1, 0.1), RGB(0.5, 0.5, 0.5), RGB(0.1, 0.1, 0.1), 10};

16 autØ
t
 = 
make_sh¬ed
<
TrŸngË
>(
m©
, 
	`Pošt3D
(-10, 1, -1), Point3D(-10, -1, -1), Point3D(-10, 1, 0));

17 
veùÜ
<
sh¬ed_±r
<
Surçû
>> 
surçûs
;

18 
surçûs
.
	`push_back
(
t
);

25 
Cam”a
 
	`ÿm”a
(
PI
/6, 1, 96, 64);

27 
ÿm”a
.
	`G‘IÁ”£ùInfo
(
surçûs
);

30 
	}
}

	@src/material.cc

1 
	~"surçû.h
"

3 
Çme¥aû
 
	gRayT¿ûr
{

	@src/point.cc

1 
	~"pošt.h
"

3 
Çme¥aû
 
	gSim¶e3D
{

	@src/ray.cc

1 
	~"¿y.h
"

2 
	~"VeùÜ3D.h
"

5 
Çme¥aû
 
	gSim¶e3D
{

	@src/render.cc

1 
	~"»nd”.h
"

2 
	~"surçû.h
"

3 
	~"ÿm”a.h
"

4 
	~"cŞÜ.h
"

5 
	~"sim¶e3d/VeùÜ3D.h
"

7 
usšg
 
	g¡d
::
veùÜ
;

8 
usšg
 
	g¡d
::
sh¬ed_±r
;

9 
usšg
 
Çme¥aû
 
	gSim¶e3D
;

11 
Çme¥aû
 
	gRayT¿ûr
{

12 
	gR’d”
::
D¿w
(cÚ¡ 
Cam”a
 &
ÿm”a
, cÚ¡ 
veùÜ
<
sh¬ed_±r
<
Surçû
>> &
surçûs
){

13 autØ
	gš‹r£ùInfoLi¡
 = 
ÿm”a
.
G‘IÁ”£ùInfo
(
surçûs
);

15 
	gveùÜ
<veùÜ<
	gRGB
>> 
cŞÜs
(
ÿm”a
.
G‘V”tiÿlPixNum
());

16 
	gi
 = 0 ; i < 
	gÿm”a
.
G‘V”tiÿlPixNum
() ; i++){

17 
	gcŞÜs
[
i
].
»size
(
ÿm”a
.
G‘HÜizÚtŞPixNum
());

20 autØ
	gi_rowCŞÜ
 = 
cŞÜs
.
begš
();

21 autØ
	gi_rowIÁ”£ùInfo
 = 
š‹r£ùInfoLi¡
.
begš
();

22 
	gi_rowCŞÜ
 !ğ
cŞÜs
.
’d
(è&& 
i_rowIÁ”£ùInfo
 !ğ
š‹r£ùInfoLi¡
.end()){

23 autØ
i_RGB
 = 
i_rowCŞÜ
->
begš
();

24 autØ
	gi_š‹r£ùInfo
 = 
i_rowIÁ”£ùInfo
->
begš
();

25 
	gi_RGB
 !ğ
i_rowCŞÜ
->
’d
(è&& 
i_š‹r£ùInfo
 !ğ
i_rowIÁ”£ùInfo
->end()){

26 
C®cuÏ‹CŞÜ
(*
i_š‹r£ùInfo
, *
i_RGB
);

27 
	gi_RGB
++;

28 
	gi_š‹r£ùInfo
++;

31 
	gi_rowCŞÜ
++;

32 
	gi_rowIÁ”£ùInfo
++;

36 
	gR’d”
::
C®cuÏ‹CŞÜ
(cÚ¡ 
IÁ”£ùInfo
 &
šfo
, 
RGB
 &
rgb
) const{

37 if(
	gšfo
.
IsEm±y
()){

38 
	grgb
.
	gr
 = 1;

39 
	grgb
.
	gg
 = 1;

40 
	grgb
.
	gb
 = 1;

43 
	grgb
 +ğ
Diffu£CŞÜ
(
šfo
.
m©
.
k_diffu£
, 
m_diffu£Light
.
š‹ns™y
, m_diffu£Light.
dœ
, info.
surçûNÜm®
);

44 autØ
	gi_¥ecuÏrLight
 = 
m_¥ecuÏrLightLi¡
.
begš
();

45 
	gi_¥ecuÏrLight
 !ğ
m_¥ecuÏrLightLi¡
.
’d
()){

46 
rgb
 +ğ
S³cuÏrCŞÜ
(
šfo
.
m©
.
k_¥ecuÏr
, 
i_¥ecuÏrLight
->
š‹ns™y
, i_¥ecuÏrLight->
dœ
,

47 
šfo
.
surçûNÜm®
, info.
r
.
G‘Dœ
(), info.
m©
.
¥ecuÏr_çùÜ
);

48 
	gi_¥ecuÏrLight
++;

50 
	grgb
 +ğ
Amb›ÁCŞÜ
(
šfo
.
m©
.
k_amb›Á
, 
m_amb›ÁLight
.
š‹ns™y
);

53 
RGB
 
	gR’d”
::
Diffu£CŞÜ
(cÚ¡ RGB &
k
, cÚ¡ RGB &
i
, cÚ¡ 
VeùÜ3D
 &
l
, cÚ¡ VeùÜ3D &
n
) const{

54 
	gco¡h‘a
 = 
DÙ
(
n
, 
l
);

55 
	gco¡h‘a
 = (0 > 
co¡h‘a
)?0:costheta;

56  
k
 * 
i
 * 
	gco¡h‘a
;

59 
RGB
 
	gR’d”
::
S³cuÏrCŞÜ
(cÚ¡ RGB &
k
, cÚ¡ RGB &
i
, cÚ¡ 
VeùÜ3D
 &
l
, cÚ¡ VeùÜ3D &
n
, cÚ¡ VeùÜ3D &
v
, 
çùÜ
) const{

60 
VeùÜ3D
 
	gh
 = 
v
 + 
l
;

61 
	gh
.
NÜm®ize
();

62 
	gco¡h‘a
 = 
DÙ
(
n
, 
h
);

63 
	gco¡h‘a
 = (0 > 
co¡h‘a
)?0:costheta;

64  (
k
 * 
	gi
è* 
pow
(
co¡h‘a
, 
çùÜ
);

67 
RGB
 
	gR’d”
::
Amb›ÁCŞÜ
(cÚ¡ RGB &
k
, cÚ¡ RGB &
i
) const{

68  
k
 * 
	gi
;

	@src/surface.cc

1 
	~"surçû.h
"

2 
	~"sim¶e3d/¿y.h
"

3 
	~"sim¶e3d/M©rix33.h
"

5 
usšg
 
Çme¥aû
 
	gSim¶e3D
;

7 
Çme¥aû
 
	gRayT¿ûr
{

8 
boŞ
 
	gTrŸngË
::
IÁ”£ùW™hRay
(cÚ¡ 
Ray
 &
r
, 
IÁ”£ùInfo
 &
šfo
) const{

9 
Pošt3D
 
	ge
 = 
r
.
G‘Pošt
(0);

10 
Pošt3D
 
	gd
 = 
r
.
G‘Pošt
(1);

11 
	gd
 -ğ
e
;

12 
Pošt3D
 
	gba
 = 
b
 - 
a
;

13 
Pošt3D
 
	gÿ
 = 
c
 - 
a
;

15 
	gd‘A
 = 
M©rix33
(
ba
.
x
, 
ÿ
.x, 
d
.x, ba.
y
, ca.y, d.y, ba.
z
, ca.z, d.z).
D‘
();

17 
	gd‘B‘a
 = 
M©rix33
(
ÿ
.
x
, ca.x, 
d
.x, ca.
y
, ca.y, d.y, ca.
z
, ca.z, d.z).
D‘
();

18 
	gb‘a
 = 
d‘B‘a
 / 
d‘A
 ;

19 
	gd‘Game
 = 
M©rix33
(
ba
.
x
, 
ÿ
.x, 
d
.x, ba.
y
, ca.y, d.y, ba.
z
, ca.z, d.z).
D‘
();

20 
	ggama
 = 
d‘Game
 / 
d‘A
;

21 
	gd‘T
 = 
M©rix33
(
ba
.
x
, 
ÿ
.x, ca.x, ba.
y
, ca.y, ca.y, ba.
z
, ca.z, ca.z).
D‘
();

22 
	gt
 = 
d‘T
 / 
d‘A
;

24 if(
	gt
 < 
	gr
.
G‘S¹R©io
(è||>„.
G‘EndR©io
())

25  
	gçl£
;

26 if(
	gb‘a
 < 0 || beta > 1)

27  
	gçl£
;

28 if(
	ggama
 < 0 || gam¨> (1 - 
	gb‘a
))

29  
	gçl£
;

31 
	gšfo
.
	gš‹rPošt
 = 
r
.
G‘Pošt
(
t
);

32 
	gšfo
.
	gsurçûNÜm®
 = 
nÜm®
;

34  
	gŒue
;

38 
boŞ
 
	gSph”e
::
IÁ”£ùW™hRay
(cÚ¡ 
Ray
 &
r
, 
IÁ”£ùInfo
 &
šfo
) const{

39 
Pošt3D
 
	ge
 = 
r
.
G‘Pošt
(0);

40 cÚ¡ 
	gVeùÜ3D
& 
	gd
 = 
r
.
G‘Dœ
();

41 
VeùÜ3D
 
ec
(
e
.
x
 - 
ûÁ”
.x,ƒ.
y
 - c’‹r.y,ƒ.
z
 - center.z);

42 
	gA
 = 
DÙ
(
d
, d);

43 
	gB
 = 2 * 
DÙ
(
d
, 
ec
);

44 
	gC
 = 
DÙ
(
ec
,ƒcè- 
	g¡d
::
pow
(
¿dius
, 2);

46 
	groÙ
 = 
¡d
::
pow
(
B
, 2è- 4 * 
A
 * 
	gC
;

47 if(
	groÙ
 < 0 )

48  
	gçl£
;

50 
	gt1
 = (-
B
 + 
¡d
::
sq¹
(
roÙ
)è/ (2 * 
A
);

51 
	gt2
 = (-
B
 - 
¡d
::
sq¹
(
roÙ
)è/ (2 * 
A
);

53 
	gt
 = 0;

54 if(
	gt2
 >ğ
r
.
G‘S¹R©io
(è&& 
t2
 <ğr.
G‘EndR©io
())

55 
t
 = 
t2
;

56 if(
	gt1
 >ğ
r
.
G‘S¹R©io
(è&& 
t1
 <ğr.
G‘EndR©io
())

57 
t
 = 
t1
;

59  
	gçl£
;

61 
Pošt3D
 
	gp
 = 
r
.
G‘Pošt
(
t
);

62 
	gšfo
.
	gš‹rPošt
 = 
p
;

63 
VeùÜ3D
 
n
(
p
.
x
 - 
ûÁ”
.x,….
y
 - c’‹r.y,….
z
 - center.z);

64 
	gn
.
NÜm®ize
();

65 
	gšfo
.
	gsurçûNÜm®
 = 
n
;

66  
	gŒue
;

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


119 #undeà
¡©ic_as£¹


120 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


152 #undeà
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifdeà
_GNU_SOURCE


158 #undeà
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #undeà
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #undeà
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #undeà
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #undeà
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #undeà
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #undeà
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #undeà
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #undeà
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #undeà
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #ià(
defšed
 
_DEFAULT_SOURCE
 \

183 || (!
defšed
 
	g__STRICT_ANSI__
 \

184 && !
defšed
 
	g_ISOC99_SOURCE
 \

185 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

186 && !
defšed
 
	g_XOPEN_SOURCE
))

187 #undeà
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC11_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

205 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

214 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifdeà
_DEFAULT_SOURCE


222 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #undeà
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #undeà
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #ià((!
defšed
 
__STRICT_ANSI__
 \

231 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #ià(
defšed
 
_POSIX_SOURCE
 \

247 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defšed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #undeà
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #undeà
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #undeà
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #ià(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #undeà
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #ià(
_XOPEN_SOURCE
 - 0) >= 600

286 #ià(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #undeà
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #undeà
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifdeà
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifdeà
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifdeà
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #ià
defšed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<¡dc-´edef.h
>

353 #undeà
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

362 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

365 #iâdeà
__ASSEMBLER__


366 #iâdeà
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

381 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

382 && 
defšed
 
	g__ex‹º_šlše


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/¡ubs.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
23
403
include/camera.h
include/color.h
include/light.h
include/material.h
include/point.h
include/ray.h
include/render.h
include/surface.h
simple3d/Matrix33.cc
simple3d/Matrix33.h
simple3d/Vector2D.h
simple3d/Vector3D.h
simple3d/commondef.h
src/camera.cc
src/main.cc
src/material.cc
src/point.cc
src/ray.cc
src/render.cc
src/surface.cc
/usr/include/assert.h
/usr/include/features.h
/usr/include/stdc-predef.h
